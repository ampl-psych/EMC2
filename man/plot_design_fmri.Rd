% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MRI.R
\name{plot_design_fmri}
\alias{plot_design_fmri}
\title{Plot fMRI Design Matrix}
\usage{
plot_design_fmri(
  design_matrix,
  TRs = 100,
  events = NULL,
  remove_nuisance = TRUE,
  subject = 1,
  legend_pos = "bottomleft",
  ...
)
}
\arguments{
\item{design_matrix}{A design matrix for fMRI analysis. Can be a data frame, matrix,
list of matrices, or an object of class 'emc.design'.}

\item{TRs}{The number of time points (TRs) to plot. Default is 100.}

\item{events}{A character vector specifying which regressors to plot. If NULL,
all non-nuisance regressors will be plotted.}

\item{remove_nuisance}{Logical indicating whether to remove nuisance regressors
(drift terms, polynomial terms, derivatives) from the plot. Default is TRUE.}

\item{subject}{The subject number to plot. Only applies for list of design matrices. Default is 1.}

\item{legend_pos}{Position of the legend. Default is "bottomleft".}

\item{...}{Additional graphical parameters passed to matplot and legend.}
}
\value{
A plot showing the design matrix regressors over time.
}
\description{
This function creates a visualization of an fMRI design matrix, showing the temporal
evolution of regressors over time. It can handle various input formats and provides
options to customize the visualization.
}
\examples{
# Create a simple design matrix
set.seed(123)
n_trs <- 200

# Create a design matrix with two conditions and drift terms
design <- data.frame(
  condition1 = c(rep(0, 20), rep(1, 10), rep(0, 170)),
  condition2 = c(rep(0, 100), rep(1, 10), rep(0, 90)),
  drift1 = seq(0, 1, length.out = n_trs),
  drift2 = seq(1, 0, length.out = n_trs),
  derivative = c(rep(0, 10), rep(1, 5), rep(0, 185))
)

# Basic plot of the design matrix
plot_design_fmri(design)

# Plot specific events only
plot_design_fmri(design, events = c("condition1", "condition2"))

# Include nuisance regressors
plot_design_fmri(design, remove_nuisance = FALSE)

# Customize the plot
plot_design_fmri(design,
                TRs = 150,
                legend_pos = "topright",
                main = "fMRI Design Matrix",
                lwd = 3)

# Example with an emc.design object
# First create a design matrix using convolve_design_matrix
timeseries <- data.frame(
  subjects = rep(1, 100),
  run = rep(1, 100),
  time = seq(0, 99),
  ROI1 = rnorm(100)
)

events <- data.frame(
  subjects = rep(1, 4),
  run = rep(1, 4),
  onset = c(10, 30, 50, 70),
  duration = rep(0.5, 4),
  event_type = c("A", "B", "A", "B"),
  modulation = c(1, 1, 1, 1)
)

# Create convolved design matrix
design_matrix <- convolve_design_matrix(
  timeseries = timeseries,
  events = events,
  factors = list(condition = c("A", "B")),
  hrf_model = "glover"
)

# Create fMRI design for EMC2
fmri_design <- design_fmri(design_matrix, model = normal_mri)

# Plot the design matrix
plot_design_fmri(fmri_design)
}
