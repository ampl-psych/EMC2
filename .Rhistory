formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
debug(run_SBC_subject)
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 1)
source("~/.active-rstudio-document", echo = TRUE)
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
debug(run_SBC_subject)
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 1)
mapply(get_ranks_ESS, split(alpha_rec, row(alpha_rec)), t(ESS), p_in)
abs(p_in - med)
p_in > CI[,1] & p_in < CI[,2]
p_in
CI
-1.21 > CI[,1]
-1.21 > -1.243
-1.21 < -1.196
p_in > CI[,1]
p_in < CIp_in > CI[,1] & p_in < CI[,3]
p_in < CIp_in > CI[,1] & p_in < CI[,3]
p_in > CI[,1] & p_in < CI[,3]
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 5)
res <- SBC_DDM_single
res
res
stack_one <- function(x) {
as_df <- function(obj) {
if (is.null(dim(obj))) {                       # named vector
val <- if (is.logical(obj)) as.integer(obj) else as.numeric(obj)
data.frame(name = names(obj), value = val, stringsAsFactors = FALSE)
} else {                                        # data.frame / matrix
df <- as.data.frame(obj, stringsAsFactors = FALSE)
if (all(vapply(df, is.logical, TRUE))) df[] <- lapply(df, as.integer)
s <- stack(df)                                # -> columns: values, ind
names(s) <- c("value", "name")
s$value <- as.numeric(s$value)
s
}
}
parts <- list(
rank     = as_df(x$rank),
med      = as_df(x$med),
bias     = as_df(x$bias),
coverage = as_df(x$coverage)
)
out <- do.call(rbind, Map(function(d, nm) { d$metric <- nm; d }, parts, names(parts)))
rownames(out) <- NULL
out[, c("metric", "name", "value")]
}
df_list <- lapply(res, stack_one)
df_list
res
out <- lapply(res, function(nm) {
do.call(rbind, lapply(x, `[[`, nm))
})
res <- SBC_DDM_single
res
out <- lapply(res, function(nm) {
do.call(rbind, lapply(x, `[[`, nm))
})
split_list_to_dfs <- function(lst) {
comps <- names(lst[[1]])   # get component names from the first element
out <- lapply(comps, function(nm) {
do.call(rbind, lapply(lst, `[[`, nm))
})
names(out) <- comps
out
}
split_list_to_dfs(res)
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 5)
plot_sbc_hist(SBC_DDM_single)
plot_sbc_ecdf(SBC_DDM_single)
debug(plot_sbc_hist)
plot_sbc_hist(SBC_DDM_single)
ranks$rank
ranks
n_sample
nrow(ranks[[1]])
load("~/Documents/2025/EMC2/vignettes/SBC_data/SBC_RDM.RData")
SBC_RDM$rank
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 5)
plot_sbc_hist(SBC_DDM_single)
SBC_DDM_single$rank
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 5)
plot_sbc_hist(SBC_DDM_single)
stats <- SBC_DDM_single
stats
NULL$NULL
a <- NULL
a$test
devtools::load_all()
plot_sbc_hist(SBC_DDM_single)
devtools::load_all()
debug(plot_sbc_hist)
plot_sbc_hist(SBC_DDM_single)
stats
ranks
ranks$rank
devtools::load_all()
debug(calc_sbc_stats)
plot_sbc_hist(SBC_DDM_single)
devtools::load_all()
debug(calc_sbc_stats)
plot_sbc_hist(SBC_DDM_single)
out
devtools::load_all()
plot_sbc_hist(SBC_DDM_single)
SBC_DDM_single
devtools::load_all()
plot_sbc_hist(SBC_DDM_single)
devtools::load_all()
plot_sbc_hist(SBC_DDM_single)
plot_sbc_ecdf(SBC_DDM_single)
load("~/Documents/2025/EMC2/vignettes/SBC_data/SBC_RDM.RData")
plot_sbc_ecdf(SBC_RDM)
load("~/Documents/2025/EMC2/vignettes/SBC_data/SBC_LBA_single.RData")
plot_sbc_ecdf(SBC_LBA_single)
devtools::document()
devtools::load_all()
devtools::check()
debug(run_SBC_subject)
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 5, functions = list(rt = pollute_rts))
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
pollute_rts <- function(rt, add_monitor_noise = TRUE, add_quantization = TRUE, add_fake_digits = TRUE,
delta_monitor = 60, delta_quant = 125, delta_bin = 60){
# Step 1: Add monitor noise
if (add_monitor_noise) {
monitor_error <- runif(n_trials, min = 0, max = delta_monitor)
rt <- rt + monitor_error
}
# Step 2: Apply quantization, this does not allow both clock and keyboard quantization
if (add_quantization) {
if (use_ceiling) {
rt <- delta_quant * ceiling(rt / delta_quant)  # Keyboard quantization
} else {
rt <- delta_quant * floor(rt / delta_quant)    # Clock quantization
}
}
# Step 3: Add fake-digit noise
if (add_fake_digits) {
fake_digit_noise <- runif(n_trials, min = 0, max = delta_bin)
rt <- rt + fake_digit_noise
}
return(rt)
}
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
debug(run_SBC_subject)
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 5, functions = list(rt = pollute_rts))
debug(run_SBC_subject)
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 1, functions = list(rt = pollute_rts))
?make_data
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
pollute_rts <- function(rt, add_monitor_noise = TRUE, add_quantization = TRUE, add_fake_digits = TRUE,
delta_monitor = 60, delta_quant = 125, delta_bin = 60){
n_trials <- length(rt)
# Step 1: Add monitor noise
if (add_monitor_noise) {
monitor_error <- runif(n_trials, min = 0, max = delta_monitor)
rt <- rt + monitor_error
}
# Step 2: Apply quantization, this does not allow both clock and keyboard quantization
if (add_quantization) {
if (use_ceiling) {
rt <- delta_quant * ceiling(rt / delta_quant)  # Keyboard quantization
} else {
rt <- delta_quant * floor(rt / delta_quant)    # Clock quantization
}
}
# Step 3: Add fake-digit noise
if (add_fake_digits) {
fake_digit_noise <- runif(n_trials, min = 0, max = delta_bin)
rt <- rt + fake_digit_noise
}
return(rt)
}
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
debug(run_SBC_subject)
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 1, functions = list(rt = pollute_rts))
rm(list = ls())
devtools::load_all()
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
pollute_rts <- function(rt, add_monitor_noise = TRUE, add_quantization = TRUE, add_fake_digits = TRUE,
use_ceiling = TRUE, delta_monitor = 60, delta_quant = 125, delta_bin = 60){
n_trials <- length(rt)
# Step 1: Add monitor noise
if (add_monitor_noise) {
monitor_error <- runif(n_trials, min = 0, max = delta_monitor)
rt <- rt + monitor_error
}
# Step 2: Apply quantization, this does not allow both clock and keyboard quantization
if (add_quantization) {
if (use_ceiling) {
rt <- delta_quant * ceiling(rt / delta_quant)  # Keyboard quantization
} else {
rt <- delta_quant * floor(rt / delta_quant)    # Clock quantization
}
}
# Step 3: Add fake-digit noise
if (add_fake_digits) {
fake_digit_noise <- runif(n_trials, min = 0, max = delta_bin)
rt <- rt + fake_digit_noise
}
return(rt)
}
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
debug(run_SBC_subject)
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 1, functions = list(rt = pollute_rts))
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
pollute_rts <- function(rt, add_monitor_noise = TRUE, add_quantization = TRUE, add_fake_digits = TRUE,
use_ceiling = TRUE, delta_monitor = 60, delta_quant = 125, delta_bin = 60){
n_trials <- length(rt)
# Step 1: Add monitor noise
if (add_monitor_noise) {
monitor_error <- runif(n_trials, min = 0, max = delta_monitor)
rt <- rt + monitor_error
}
# Step 2: Apply quantization, this does not allow both clock and keyboard quantization
if (add_quantization) {
if (use_ceiling) {
rt <- delta_quant * ceiling(rt / delta_quant)  # Keyboard quantization
} else {
rt <- delta_quant * floor(rt / delta_quant)    # Clock quantization
}
}
# Step 3: Add fake-digit noise
if (add_fake_digits) {
fake_digit_noise <- runif(n_trials, min = 0, max = delta_bin)
rt <- rt + fake_digit_noise
}
return(rt)
}
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
debug(pollute_rts)
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 1, functions = list(rt = pollute_rts))
rt
devtools::load_all()
devtools::check()
devtools::document()
devtools::load_all()
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
pollute_rts <- function(rt, add_monitor_noise = TRUE, add_quantization = TRUE, add_fake_digits = TRUE,
use_ceiling = TRUE, delta_monitor = 1/60, delta_quant = 1/125, delta_bin = 1/60){
rt <- data$rt
n_trials <- length(rt)
# Step 1: Add monitor noise
if (add_monitor_noise) {
monitor_error <- runif(n_trials, min = 0, max = delta_monitor)
rt <- rt + monitor_error
}
# Step 2: Apply quantization, this does not allow both clock and keyboard quantization
if (add_quantization) {
if (use_ceiling) {
rt <- delta_quant * ceiling(rt / delta_quant)  # Keyboard quantization
} else {
rt <- delta_quant * floor(rt / delta_quant)    # Clock quantization
}
}
# Step 3: Add fake-digit noise
if (add_fake_digits) {
fake_digit_noise <- runif(n_trials, min = 0, max = delta_bin)
rt <- rt + fake_digit_noise
}
return(rt)
}
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
debug(pollute_rts)
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 1, post_functions = list(rt = pollute_rts))
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
pollute_rts <- function(data, add_monitor_noise = TRUE, add_quantization = TRUE, add_fake_digits = TRUE,
use_ceiling = TRUE, delta_monitor = 1/60, delta_quant = 1/125, delta_bin = 1/60){
rt <- data$rt
n_trials <- length(rt)
# Step 1: Add monitor noise
if (add_monitor_noise) {
monitor_error <- runif(n_trials, min = 0, max = delta_monitor)
rt <- rt + monitor_error
}
# Step 2: Apply quantization, this does not allow both clock and keyboard quantization
if (add_quantization) {
if (use_ceiling) {
rt <- delta_quant * ceiling(rt / delta_quant)  # Keyboard quantization
} else {
rt <- delta_quant * floor(rt / delta_quant)    # Clock quantization
}
}
# Step 3: Add fake-digit noise
if (add_fake_digits) {
fake_digit_noise <- runif(n_trials, min = 0, max = delta_bin)
rt <- rt + fake_digit_noise
}
return(rt)
}
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
debug(pollute_rts)
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 1, post_functions = list(rt = pollute_rts))
rt
data$rt
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
pollute_rts <- function(data, add_monitor_noise = TRUE, add_quantization = TRUE, add_fake_digits = TRUE,
use_ceiling = TRUE, delta_monitor = 1/60, delta_quant = 1/125, delta_bin = 1/60){
rt <- data$rt
n_trials <- length(rt)
# Step 1: Add monitor noise
if (add_monitor_noise) {
monitor_error <- runif(n_trials, min = 0, max = delta_monitor)
rt <- rt + monitor_error
}
# Step 2: Apply quantization, this does not allow both clock and keyboard quantization
if (add_quantization) {
if (use_ceiling) {
rt <- delta_quant * ceiling(rt / delta_quant)  # Keyboard quantization
} else {
rt <- delta_quant * floor(rt / delta_quant)    # Clock quantization
}
}
# Step 3: Add fake-digit noise
if (add_fake_digits) {
fake_digit_noise <- runif(n_trials, min = 0, max = delta_bin)
rt <- rt + fake_digit_noise
}
return(rt)
}
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50,
fileName = "SBC_DDM.RData", cores_per_chain = 1, post_functions = list(rt = pollute_rts))
devtools::load_all()
devtools::load_all()
plot_sbc_hist(SBC_DDM_single)
plot_sbc_ecdf(SBC_DDM_single)
rm(list = ls())
devtools::load_all()
design_DDM <- design(factors=list(subjects=1,S=c("left", "right")),
Rlevels = c("left", "right"),
formula =list(v~1,a~1, t0~1, s~1, Z~1, sv~1),
constants=c(s=log(1)),
model = DDM)
pollute_rts <- function(data, add_monitor_noise = TRUE, add_quantization = TRUE, add_fake_digits = TRUE,
use_ceiling = TRUE, delta_monitor = 1/60, delta_quant = 1/125, delta_bin = 1/60){
rt <- data$rt
n_trials <- length(rt)
# Step 1: Add monitor noise
if (add_monitor_noise) {
monitor_error <- runif(n_trials, min = 0, max = delta_monitor)
rt <- rt + monitor_error
}
# Step 2: Apply quantization, this does not allow both clock and keyboard quantization
if (add_quantization) {
if (use_ceiling) {
rt <- delta_quant * ceiling(rt / delta_quant)  # Keyboard quantization
} else {
rt <- delta_quant * floor(rt / delta_quant)    # Clock quantization
}
}
# Step 3: Add fake-digit noise
if (add_fake_digits) {
fake_digit_noise <- runif(n_trials, min = 0, max = delta_bin)
rt <- rt + fake_digit_noise
}
return(rt)
}
prior_DDM <- prior(design_DDM, type = "single",
pmean = c(1, log(.8), log(.3), qnorm(.5), log(.1)),
psd = c(.15, .15, .1, .05, .15))
SBC_DDM_single <- run_sbc(design_DDM, prior_DDM, replicates = 5, trials = 50, rt_resolution = 1/60, compress = TRUE,
fileName = "SBC_DDM.RData", cores_per_chain = 1, post_functions = list(rt = pollute_rts))
devtools::document()
devtools::load_all()
devtools::check()
devtools::test()
testthat::snapshot_review('Darwin/variant_funs')
testthat::snapshot_review('trend')
testthat::snapshot_accept('model_functions')
testthat::snapshot_accept('model_functions')
testthat::snapshot_review('profile/')
devtools::test()
testthat::snapshot_accept('stopS')
testthat::snapshot_accept('Darwin/fit')
testthat::snapshot_accept('make_emc')
devtools::test()
testthat::snapshot_accept('new_models')
testthat::snapshot_accept('group')
testthat::snapshot_accept('joint')
devtools::test()
devtools::check()
devtools::load_all()
devtools::load_all()
plot_cdf(forstmann)
plot_cdf(get_data(samples_LNR))
plot_cdf(samples_LNR, to_plot = "data")
?plot_cdf
